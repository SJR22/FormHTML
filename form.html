<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–î–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
  h2 { text-align: center; }
  label { display: block; margin-top: 10px; font-weight: bold; }
  input { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
  button {
    background: #0088cc; color: white; border: none; padding: 10px;
    margin-top: 20px; width: 100%; font-size: 16px; cursor: pointer;
  }
  .copy-btn {
    background: #28a745; margin-top: 10px;
  }
  textarea {
    width: 100%; height: 100px; margin-top: 10px; display: none;
  }
</style>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <h2>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</h2>
  <form id="proxyForm">
    <label>–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ <input name="order_number" required></label>
    <label>–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ <input name="order_date" type="date" required></label>
    <label>–§–ò–û –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–∞ <input name="payer_name" required></label>
    <label>–¢–µ–ª. –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–∞ <input name="payer_phone" required></label>
    <label>–ü–∞—Å–ø–æ—Ä—Ç –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–∞ <input name="payer_passport" required></label>
    <label>Email <input name="email" type="email" required></label>
    <label>–§–ò–û –ø–æ–ª—É—á–∞—Ç–µ–ª—è <input name="recipient_name" required></label>
    <label>–¢–µ–ª. –ø–æ–ª—É—á–∞—Ç–µ–ª—è <input name="recipient_phone" required></label>
    <label>–ü–∞—Å–ø–æ—Ä—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª—è <input name="recipient_passport" required></label>
    <label>–°—É–º–º–∞ <input name="amount" required></label>
    <label>–î–æ–º–∞—à–Ω–∏–π –∞–¥—Ä–µ—Å <input name="Home_address"></label>
    <label>–ê–¥—Ä–µ—Å –¢–ö <input name="Address_TC"></label>
    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –¢–ö <input name="Name_TC"></label>
    <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </form>

  <button class="copy-btn" onclick="copyData()">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
  <textarea id="dataOutput"></textarea>

<script>
  const tg = window.Telegram.WebApp;
  tg.expand();
  tg.enableClosingConfirmation();

  document.getElementById("proxyForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const formData = new FormData(this);
    const data = Object.fromEntries(formData.entries());
    
    if (tg && tg.sendData) {
        try {
            tg.sendData(JSON.stringify(data));
            console.log("–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –±–æ—Ç–∞:", data);
        } catch (error) {
            console.error("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö:", error);
            alert("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã. –°–æ–æ–±—â–∏—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.");
        }
        tg.close();
    } else {
        console.error("Telegram WebApp API –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω.");
        alert("–û—à–∏–±–∫–∞ —Å–≤—è–∑–∏ —Å Telegram. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.");
    }
  });

  function copyData() {
    const formData = new FormData(document.getElementById("proxyForm"));
    const data = Object.fromEntries(formData.entries());
    const jsonData = JSON.stringify(data, null, 2);
    
    document.getElementById("dataOutput").value = jsonData;
    document.getElementById("dataOutput").style.display = 'block';
    
    navigator.clipboard.writeText(jsonData).then(() => {
        alert('–î–∞–Ω–Ω—ã–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã! –¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∏—Ö –±–æ—Ç—É –∫–∞–∫ —Å–æ–æ–±—â–µ–Ω–∏–µ.');
    });
  }
</script>
</body>
</html>
